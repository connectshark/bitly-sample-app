import{r as b,o as i,c as l,a,b as u,w as f,d as x,F as m,e as I,f as S,t as g,g as w,u as T,h as R,i as v,S as O,j as D,k as B,l as C,m as N}from"./vendor.b9754ea2.js";const V=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function e(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=e(t);fetch(t.href,s)}};V();var $=(o,n)=>{const e=o.__vccOpts||o;for(const[r,t]of n)e[r]=t;return e};const A={},z={class:"py-6 text-3xl"},G=x("BLD"),U={class:"text-base"},j=x("\u767B\u5165");function F(o,n){const e=b("router-link");return i(),l("header",z,[a("h1",null,[u(e,{to:"/"},{default:f(()=>[G]),_:1})]),a("nav",null,[a("ul",U,[a("li",null,[u(e,{to:"/login"},{default:f(()=>[j]),_:1})])])])])}var H=$(A,[["render",F]]);const W={setup(o){return(n,e)=>{const r=b("router-view");return i(),l(m,null,[u(H),a("main",null,[u(r)])],64)}}},q="modulepreload",k={},K="/bitly-sample-app/",L=function(n,e){return!e||e.length===0?n():Promise.all(e.map(r=>{if(r=`${K}${r}`,r in k)return;k[r]=!0;const t=r.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${s}`))return;const c=document.createElement("link");if(c.rel=t?"stylesheet":q,t||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),t)return new Promise((_,P)=>{c.addEventListener("load",_),c.addEventListener("error",P)})})).then(()=>n())},J=I("link",{state:()=>({token:{}.VITE_TOKEN,guid:""}),getters:{},actions:{}}),d={}.VITE_API_URL,M={}.VITE_REDIRECT_URL,Q={}.VITE_CLIENT_ID,p={auth(o){const n=new URLSearchParams({client_id:Q,code:o,redirect_uri:M,grant_type:"authorization_code"});return new Promise((e,r)=>{fetch(d+"/oauth/access_token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then(t=>(console.log(t),t.text())).then(t=>e(t)).catch(t=>r(t))})},getBSDs(){return new Promise((o,n)=>{fetch(d+"/v4/bsds",{headers:h()}).then(e=>e.json()).then(e=>o(e)).catch(e=>n(e))})},getGroups(){return new Promise((o,n)=>{fetch(d+"/v4/groups",{headers:h()}).then(e=>e.json()).then(e=>o(e)).catch(e=>n(e))})},getOrganizations(){return new Promise((o,n)=>{fetch(d+"/v4/organizations",{headers:h()}).then(e=>e.json()).then(e=>o(e)).catch(e=>n(e))})},getGroupLinks(o){return new Promise((n,e)=>{fetch(d+`/v4/groups/${o}/bitlinks`,{headers:h()}).then(r=>r.json()).then(r=>n(r)).catch(r=>e(r))})}},h=()=>{const o=J();return{Authorization:"Bearer "+o.token}},X={class:"text-left w-11/12 mx-auto"},Y={class:""},Z={class:"text-sm"},ee={class:"text-xs hover:underline cursor-pointer"},te=a("i",{class:"bx bx-detail"},null,-1),ne={props:{guid:String},async setup(o){let n,e;const r=o,{links:t}=([n,e]=S(()=>p.getGroupLinks(r.guid)),n=await n,e(),n);return(s,c)=>(i(),l("section",X,[a("h3",null,"Group ID: "+g(r.guid),1),a("ul",Y,[(i(!0),l(m,null,w(T(t),_=>(i(),l("li",{class:"mb-1 bg-zinc-900 p-2 rounded-xl",key:_.id},[a("h4",Z,g(_.title),1),a("p",ee,[x(g(_.link),1),te])]))),128))])]))}},re={},oe={class:"text-center text-2xl"},se=a("i",{class:"bx bx-loader-alt bx-spin"},null,-1),ce=[se];function ae(o,n){return i(),l("div",oe,ce)}var E=$(re,[["render",ae]]);const ie=a("h2",null,"welcome ",-1),le={setup(o){const n=R([]);return p.getBSDs(),p.getGroups().then(e=>{n.value=e.groups}),p.getOrganizations(),(e,r)=>(i(),l(m,null,[ie,u(E),(i(),v(O,null,{fallback:f(()=>[u(E)]),default:f(()=>[(i(!0),l(m,null,w(n.value,t=>(i(),v(ne,{key:t.guid,guid:t.guid},null,8,["guid"]))),128))]),_:1}))],64))}},ue=D({history:B("/bitly-sample-app/"),scrollBehavior(){return{top:0}},routes:[{path:"/",name:"home",component:le},{path:"/auth",name:"auth",component:()=>L(()=>import("./authView.e462a1e8.js"),["assets/authView.e462a1e8.js","assets/vendor.b9754ea2.js"])},{path:"/login",name:"login",component:()=>L(()=>import("./loginView.f229d1eb.js"),["assets/loginView.f229d1eb.js","assets/vendor.b9754ea2.js"])}]}),y=C(W);y.use(N());y.use(ue);y.mount("#app");export{$ as _,p as a,J as u};
